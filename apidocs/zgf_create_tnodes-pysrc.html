<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>zgf_create_tnodes</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
	
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [['$$', '$$'], ["\\[", "\\]"]]
      }
    });
    </script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	</head>
	

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ZIBMolPy-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="https://wiki.kobv.de/confluence/display/AGCMD/ZIBMolPy">ZIBMolPy</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Module&nbsp;zgf_create_tnodes
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="zgf_create_tnodes-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="zgf_create_tnodes-module.html">Module zgf_create_tnodes</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment">#!/usr/bin/python</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># -*- coding: utf-8 -*-</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-docstring">"""</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-docstring">What it does</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-docstring">============</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-docstring">        B{This is the ninth step of ZIBgridfree.}</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-docstring">        This tool adds additional nodes to the pool called transition (or 'T') nodes. They are essential to find out the probability to move either</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-docstring">                1. from one metastable cluster to another (transition-level 'clusters', matrix $P_c(\\tau)$) or</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-docstring">                2. from one node to another (transition-level 'nodes', matrix $P(\\tau)$).</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-docstring">        If one decides to choose 'cluster', one gets soft clusters in the spirit of PCCA+, where each configuration belongs to a specific cluster with a certain probability. If one chooses 'nodes', than one gets a hard clustering in terms of a Voronoi tesselation, where the center of each Voronoi cell is represented by a node of the pool.</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-docstring">        In general, one assumes that more transition nodes lead to more accurate probability information. After creating transition nodes, L{zgf_mdrun} has to be run again in order to perform the transition sampling, namely 'num-runs' trajectories of 'sampling-length' ps length. Finally, the transition matrix can be computed by calling L{zgf_create_pmatrix}. The amount of transition nodes that is created depends on the user input and is described in the following.</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-docstring">        B{The next step is L{zgf_create_pmatrix}.}</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-docstring">How it works</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-docstring">============</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-docstring">        At the command line, type::</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-docstring">                $ zgf_create_tnodes [options]</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-docstring">Clusters</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-docstring">========</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-docstring">        The clusters identified by PCCA+ are described in terms of the $\chi$ matrix. For the transition probability computation, a node is assumed to belong to such a cluster if its $\chi$-Value is larger than 0.5. For each node that belongs to a given cluster, this method generates 'num-tnodes' transition nodes. To avoid unnecessary computational cost, one can avoid creating 'num-tnodes' for those nodes where the $\chi$-Value is already very close to 1 since one can assume that trajectories starting from those points will most likely not undergo a transition. The user may only generate 'num-tnodes' for a node that belongs to a cluster with a percentage between 0.5 and X where X is the 'coreset-power'. Each node that belongs to a cluster will spawn 'num-tnodes' transition nodes.</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-docstring">Nodes (Voronoi cells)</tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt class="py-docstring">=====================</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt class="py-docstring">        Each Voronoi cell gets 'num-tnodes' transition nodes.   </tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"><tt class="py-docstring">Save mode</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"><tt class="py-docstring">=========</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"><tt class="py-docstring">        After execution of L{zgf_mdrun}, each transition node creates trr, edr and log files. These files require disk space, but are not needed to calculate the transition probability. If one is going to choose the 'pdb' option, then the trr, edr and log files are deleted. If for any reasons those files are needed, deletion can be avoided by choosing the value 'complete'. </tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"><tt class="py-docstring">"""</tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line"> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package ZIBMolPy=ZIBMolPy-module.html"><a title="ZIBMolPy" class="py-name" href="#" onclick="return doclink('link-0', 'ZIBMolPy', 'link-0');">ZIBMolPy</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Variable ZIBMolPy.node.Node.pool=ZIBMolPy.node.Node-class.html#pool,Module ZIBMolPy.pool=ZIBMolPy.pool-module.html"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-1', 'pool', 'link-1');">pool</a></tt> <tt class="py-keyword">import</tt> <tt id="link-2" class="py-name" targets="Class ZIBMolPy.pool.Pool=ZIBMolPy.pool.Pool-class.html"><a title="ZIBMolPy.pool.Pool" class="py-name" href="#" onclick="return doclink('link-2', 'Pool', 'link-2');">Pool</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-3" class="py-name"><a title="ZIBMolPy" class="py-name" href="#" onclick="return doclink('link-3', 'ZIBMolPy', 'link-0');">ZIBMolPy</a></tt><tt class="py-op">.</tt><tt id="link-4" class="py-name" targets="Module ZIBMolPy.node=ZIBMolPy.node-module.html"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-4', 'node', 'link-4');">node</a></tt> <tt class="py-keyword">import</tt> <tt id="link-5" class="py-name" targets="Class ZIBMolPy.node.Node=ZIBMolPy.node.Node-class.html"><a title="ZIBMolPy.node.Node" class="py-name" href="#" onclick="return doclink('link-5', 'Node', 'link-5');">Node</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-6" class="py-name"><a title="ZIBMolPy" class="py-name" href="#" onclick="return doclink('link-6', 'ZIBMolPy', 'link-0');">ZIBMolPy</a></tt><tt class="py-op">.</tt><tt id="link-7" class="py-name" targets="Module ZIBMolPy.phi=ZIBMolPy.phi-module.html"><a title="ZIBMolPy.phi" class="py-name" href="#" onclick="return doclink('link-7', 'phi', 'link-7');">phi</a></tt>  <tt class="py-keyword">import</tt> <tt id="link-8" class="py-name" targets="Function ZIBMolPy.phi.get_phi()=ZIBMolPy.phi-module.html#get_phi"><a title="ZIBMolPy.phi.get_phi" class="py-name" href="#" onclick="return doclink('link-8', 'get_phi', 'link-8');">get_phi</a></tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-9" class="py-name"><a title="ZIBMolPy" class="py-name" href="#" onclick="return doclink('link-9', 'ZIBMolPy', 'link-0');">ZIBMolPy</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name" targets="Module ZIBMolPy.ui=ZIBMolPy.ui-module.html"><a title="ZIBMolPy.ui" class="py-name" href="#" onclick="return doclink('link-10', 'ui', 'link-10');">ui</a></tt> <tt class="py-keyword">import</tt> <tt id="link-11" class="py-name" targets="Function ZIBMolPy.ui.userinput()=ZIBMolPy.ui-module.html#userinput"><a title="ZIBMolPy.ui.userinput" class="py-name" href="#" onclick="return doclink('link-11', 'userinput', 'link-11');">userinput</a></tt><tt class="py-op">,</tt> <tt id="link-12" class="py-name" targets="Class ZIBMolPy.ui.Option=ZIBMolPy.ui.Option-class.html"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-12', 'Option', 'link-12');">Option</a></tt><tt class="py-op">,</tt> <tt id="link-13" class="py-name" targets="Class ZIBMolPy.ui.OptionsList=ZIBMolPy.ui.OptionsList-class.html"><a title="ZIBMolPy.ui.OptionsList" class="py-name" href="#" onclick="return doclink('link-13', 'OptionsList', 'link-13');">OptionsList</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt id="link-14" class="py-name" targets="Module zgf_setup_nodes=zgf_setup_nodes-module.html"><a title="zgf_setup_nodes" class="py-name" href="#" onclick="return doclink('link-14', 'zgf_setup_nodes', 'link-14');">zgf_setup_nodes</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt id="link-15" class="py-name" targets="Module zgf_grompp=zgf_grompp-module.html"><a title="zgf_grompp" class="py-name" href="#" onclick="return doclink('link-15', 'zgf_grompp', 'link-15');">zgf_grompp</a></tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">sys</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">numpy</tt> <tt class="py-keyword">as</tt> <tt class="py-name">np</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"><tt id="link-16" class="py-name" targets="Variable zgf_analyze.options_desc=zgf_analyze-module.html#options_desc,Variable zgf_cleanup.options_desc=zgf_cleanup-module.html#options_desc,Variable zgf_concatenate_stuff.options_desc=zgf_concatenate_stuff-module.html#options_desc,Variable zgf_create_nodes.options_desc=zgf_create_nodes-module.html#options_desc,Variable zgf_create_pmatrix.options_desc=zgf_create_pmatrix-module.html#options_desc,Variable zgf_create_pool.options_desc=zgf_create_pool-module.html#options_desc,Variable zgf_create_rates.options_desc=zgf_create_rates-module.html#options_desc,Variable zgf_create_tnodes.options_desc=zgf_create_tnodes-module.html#options_desc,Variable zgf_create_unrestrained_nodes.options_desc=zgf_create_unrestrained_nodes-module.html#options_desc,Variable zgf_discard_solvent.options_desc=zgf_discard_solvent-module.html#options_desc,Variable zgf_export_pool.options_desc=zgf_export_pool-module.html#options_desc,Variable zgf_extract_conformations.options_desc=zgf_extract_conformations-module.html#options_desc,Variable zgf_genion.options_desc=zgf_genion-module.html#options_desc,Variable zgf_grompp.options_desc=zgf_grompp-module.html#options_desc,Variable zgf_mdrun.options_desc=zgf_mdrun-module.html#options_desc,Variable zgf_recover_state.options_desc=zgf_recover_state-module.html#options_desc,Variable zgf_refine.options_desc=zgf_refine-module.html#options_desc,Variable zgf_remove_nodes.options_desc=zgf_remove_nodes-module.html#options_desc,Variable zgf_rerun.options_desc=zgf_rerun-module.html#options_desc,Variable zgf_reweight.options_desc=zgf_reweight-module.html#options_desc,Variable zgf_reweight_wham.options_desc=zgf_reweight_wham-module.html#options_desc,Variable zgf_setup_nodes.options_desc=zgf_setup_nodes-module.html#options_desc,Variable zgf_solvate_nodes.options_desc=zgf_solvate_nodes-module.html#options_desc,Variable zgf_submit_job_HLRN.options_desc=zgf_submit_job_HLRN-module.html#options_desc,Variable zgf_upgrade.options_desc=zgf_upgrade-module.html#options_desc"><a title="zgf_analyze.options_desc
zgf_cleanup.options_desc
zgf_concatenate_stuff.options_desc
zgf_create_nodes.options_desc
zgf_create_pmatrix.options_desc
zgf_create_pool.options_desc
zgf_create_rates.options_desc
zgf_create_tnodes.options_desc
zgf_create_unrestrained_nodes.options_desc
zgf_discard_solvent.options_desc
zgf_export_pool.options_desc
zgf_extract_conformations.options_desc
zgf_genion.options_desc
zgf_grompp.options_desc
zgf_mdrun.options_desc
zgf_recover_state.options_desc
zgf_refine.options_desc
zgf_remove_nodes.options_desc
zgf_rerun.options_desc
zgf_reweight.options_desc
zgf_reweight_wham.options_desc
zgf_setup_nodes.options_desc
zgf_solvate_nodes.options_desc
zgf_submit_job_HLRN.options_desc
zgf_upgrade.options_desc" class="py-name" href="#" onclick="return doclink('link-16', 'options_desc', 'link-16');">options_desc</a></tt> <tt class="py-op">=</tt> <tt id="link-17" class="py-name"><a title="ZIBMolPy.ui.OptionsList" class="py-name" href="#" onclick="return doclink('link-17', 'OptionsList', 'link-13');">OptionsList</a></tt><tt class="py-op">(</tt><tt class="py-op">[</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">        <tt id="link-18" class="py-name"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-18', 'Option', 'link-12');">Option</a></tt><tt class="py-op">(</tt><tt class="py-string">"t"</tt><tt class="py-op">,</tt> <tt class="py-string">"transition-level"</tt><tt class="py-op">,</tt> <tt class="py-string">"choice"</tt><tt class="py-op">,</tt> <tt class="py-string">"transition level"</tt><tt class="py-op">,</tt> <tt class="py-name">choices</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-string">"clusters"</tt><tt class="py-op">,</tt><tt class="py-string">"nodes"</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">        <tt id="link-19" class="py-name"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-19', 'Option', 'link-12');">Option</a></tt><tt class="py-op">(</tt><tt class="py-string">"n"</tt><tt class="py-op">,</tt> <tt class="py-string">"num-tnodes"</tt><tt class="py-op">,</tt> <tt class="py-string">"int"</tt><tt class="py-op">,</tt> <tt class="py-string">"number of tnodes per node"</tt><tt class="py-op">,</tt> <tt class="py-name">default</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">min_value</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">        <tt id="link-20" class="py-name"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-20', 'Option', 'link-12');">Option</a></tt><tt class="py-op">(</tt><tt class="py-string">"r"</tt><tt class="py-op">,</tt> <tt class="py-string">"num-runs"</tt><tt class="py-op">,</tt> <tt class="py-string">"int"</tt><tt class="py-op">,</tt> <tt class="py-string">"number of runs"</tt><tt class="py-op">,</tt> <tt class="py-name">default</tt><tt class="py-op">=</tt><tt class="py-number">5</tt><tt class="py-op">,</tt> <tt class="py-name">min_value</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">        <tt id="link-21" class="py-name"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-21', 'Option', 'link-12');">Option</a></tt><tt class="py-op">(</tt><tt class="py-string">"l"</tt><tt class="py-op">,</tt> <tt class="py-string">"sampling-length"</tt><tt class="py-op">,</tt> <tt class="py-string">"int"</tt><tt class="py-op">,</tt> <tt class="py-string">"length of sampling per run in ps"</tt><tt class="py-op">,</tt> <tt class="py-name">default</tt><tt class="py-op">=</tt><tt class="py-number">100</tt><tt class="py-op">,</tt> <tt class="py-name">min_value</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line">        <tt id="link-22" class="py-name"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-22', 'Option', 'link-12');">Option</a></tt><tt class="py-op">(</tt><tt class="py-string">"s"</tt><tt class="py-op">,</tt> <tt class="py-string">"save-mode"</tt><tt class="py-op">,</tt> <tt class="py-string">"choice"</tt><tt class="py-op">,</tt> <tt class="py-string">"files to store"</tt><tt class="py-op">,</tt> <tt class="py-name">choices</tt><tt class="py-op">=</tt><tt class="py-op">(</tt><tt class="py-string">"pdb"</tt><tt class="py-op">,</tt><tt class="py-string">"complete"</tt><tt class="py-op">)</tt> <tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">        <tt id="link-23" class="py-name"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-23', 'Option', 'link-12');">Option</a></tt><tt class="py-op">(</tt><tt class="py-string">"c"</tt><tt class="py-op">,</tt> <tt class="py-string">"coreset-power"</tt><tt class="py-op">,</tt> <tt class="py-string">"float"</tt><tt class="py-op">,</tt> <tt class="py-string">"ignore nodes with chi value higher than coreset-power ('clusters' only)"</tt><tt class="py-op">,</tt> <tt class="py-name">default</tt><tt class="py-op">=</tt><tt class="py-number">0.9</tt><tt class="py-op">,</tt> <tt class="py-name">min_value</tt><tt class="py-op">=</tt><tt class="py-number">0.5</tt><tt class="py-op">)</tt><tt class="py-op">,</tt>    </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">        <tt id="link-24" class="py-name"><a title="ZIBMolPy.ui.Option" class="py-name" href="#" onclick="return doclink('link-24', 'Option', 'link-12');">Option</a></tt><tt class="py-op">(</tt><tt class="py-string">"m"</tt><tt class="py-op">,</tt> <tt class="py-string">"min-nodes"</tt><tt class="py-op">,</tt> <tt class="py-string">"int"</tt><tt class="py-op">,</tt> <tt class="py-string">"min number of nodes to consider ('clusters' only)"</tt><tt class="py-op">,</tt> <tt class="py-name">default</tt><tt class="py-op">=</tt><tt class="py-number">3</tt><tt class="py-op">,</tt> <tt class="py-name">min_value</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">        <tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line"><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">modules</tt><tt class="py-op">[</tt><tt class="py-name">__name__</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">__doc__</tt> <tt class="py-op">+=</tt> <tt id="link-25" class="py-name"><a title="zgf_analyze.options_desc
zgf_cleanup.options_desc
zgf_concatenate_stuff.options_desc
zgf_create_nodes.options_desc
zgf_create_pmatrix.options_desc
zgf_create_pool.options_desc
zgf_create_rates.options_desc
zgf_create_tnodes.options_desc
zgf_create_unrestrained_nodes.options_desc
zgf_discard_solvent.options_desc
zgf_export_pool.options_desc
zgf_extract_conformations.options_desc
zgf_genion.options_desc
zgf_grompp.options_desc
zgf_mdrun.options_desc
zgf_recover_state.options_desc
zgf_refine.options_desc
zgf_remove_nodes.options_desc
zgf_rerun.options_desc
zgf_reweight.options_desc
zgf_reweight_wham.options_desc
zgf_setup_nodes.options_desc
zgf_solvate_nodes.options_desc
zgf_submit_job_HLRN.options_desc
zgf_upgrade.options_desc" class="py-name" href="#" onclick="return doclink('link-25', 'options_desc', 'link-16');">options_desc</a></tt><tt class="py-op">.</tt><tt id="link-26" class="py-name" targets="Method ZIBMolPy.ui.OptionsList.epytext()=ZIBMolPy.ui.OptionsList-class.html#epytext"><a title="ZIBMolPy.ui.OptionsList.epytext" class="py-name" href="#" onclick="return doclink('link-26', 'epytext', 'link-26');">epytext</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-comment"># for epydoc</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line"> </tt>
<a name="is_applicable"></a><div id="is_applicable-def"><a name="L64"></a><tt class="py-lineno"> 64</tt> <a class="py-toggle" href="#" id="is_applicable-toggle" onclick="return toggle('is_applicable');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="zgf_create_tnodes-module.html#is_applicable">is_applicable</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="is_applicable-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="is_applicable-expanded"><a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">        <tt id="link-27" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-27', 'pool', 'link-1');">pool</a></tt> <tt class="py-op">=</tt> <tt id="link-28" class="py-name"><a title="ZIBMolPy.pool.Pool" class="py-name" href="#" onclick="return doclink('link-28', 'Pool', 'link-2');">Pool</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt id="link-29" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-29', 'pool', 'link-1');">pool</a></tt><tt class="py-op">.</tt><tt id="link-30" class="py-name" targets="Variable ZIBMolPy.pool.Pool.chi_mat_fn=ZIBMolPy.pool.Pool-class.html#chi_mat_fn"><a title="ZIBMolPy.pool.Pool.chi_mat_fn" class="py-name" href="#" onclick="return doclink('link-30', 'chi_mat_fn', 'link-30');">chi_mat_fn</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">         </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line"> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line"><tt class="py-comment">#===============================================================================</tt> </tt>
<a name="main"></a><div id="main-def"><a name="L70"></a><tt class="py-lineno"> 70</tt> <a class="py-toggle" href="#" id="main-toggle" onclick="return toggle('main');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="zgf_create_tnodes-module.html#main">main</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="main-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="main-expanded"><a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">        <tt class="py-name">options</tt> <tt class="py-op">=</tt> <tt id="link-31" class="py-name"><a title="zgf_analyze.options_desc
zgf_cleanup.options_desc
zgf_concatenate_stuff.options_desc
zgf_create_nodes.options_desc
zgf_create_pmatrix.options_desc
zgf_create_pool.options_desc
zgf_create_rates.options_desc
zgf_create_tnodes.options_desc
zgf_create_unrestrained_nodes.options_desc
zgf_discard_solvent.options_desc
zgf_export_pool.options_desc
zgf_extract_conformations.options_desc
zgf_genion.options_desc
zgf_grompp.options_desc
zgf_mdrun.options_desc
zgf_recover_state.options_desc
zgf_refine.options_desc
zgf_remove_nodes.options_desc
zgf_rerun.options_desc
zgf_reweight.options_desc
zgf_reweight_wham.options_desc
zgf_setup_nodes.options_desc
zgf_solvate_nodes.options_desc
zgf_submit_job_HLRN.options_desc
zgf_upgrade.options_desc" class="py-name" href="#" onclick="return doclink('link-31', 'options_desc', 'link-16');">options_desc</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name" targets="Method ZIBMolPy.ui.OptionsList.parse_args()=ZIBMolPy.ui.OptionsList-class.html#parse_args"><a title="ZIBMolPy.ui.OptionsList.parse_args" class="py-name" href="#" onclick="return doclink('link-32', 'parse_args', 'link-32');">parse_args</a></tt><tt class="py-op">(</tt><tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">argv</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line"> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">        <tt id="link-33" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-33', 'pool', 'link-1');">pool</a></tt> <tt class="py-op">=</tt> <tt id="link-34" class="py-name"><a title="ZIBMolPy.pool.Pool" class="py-name" href="#" onclick="return doclink('link-34', 'Pool', 'link-2');">Pool</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">        <tt class="py-name">active_nodes</tt> <tt class="py-op">=</tt> <tt id="link-35" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-35', 'pool', 'link-1');">pool</a></tt><tt class="py-op">.</tt><tt id="link-36" class="py-name" targets="Method ZIBMolPy.pool.NodeList.where()=ZIBMolPy.pool.NodeList-class.html#where"><a title="ZIBMolPy.pool.NodeList.where" class="py-name" href="#" onclick="return doclink('link-36', 'where', 'link-36');">where</a></tt><tt class="py-op">(</tt><tt class="py-string">"isa_partition"</tt><tt class="py-op">)</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line"> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">transition_level</tt> <tt class="py-op">==</tt> <tt class="py-string">"clusters"</tt><tt class="py-op">:</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">                <tt class="py-name">npz_file</tt> <tt class="py-op">=</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">load</tt><tt class="py-op">(</tt><tt id="link-37" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-37', 'pool', 'link-1');">pool</a></tt><tt class="py-op">.</tt><tt id="link-38" class="py-name"><a title="ZIBMolPy.pool.Pool.chi_mat_fn" class="py-name" href="#" onclick="return doclink('link-38', 'chi_mat_fn', 'link-30');">chi_mat_fn</a></tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">                <tt class="py-name">chi_matrix</tt> <tt class="py-op">=</tt> <tt class="py-name">npz_file</tt><tt class="py-op">[</tt><tt class="py-string">'matrix'</tt><tt class="py-op">]</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">                <tt class="py-name">n_clusters</tt> <tt class="py-op">=</tt> <tt class="py-name">npz_file</tt><tt class="py-op">[</tt><tt class="py-string">'n_clusters'</tt><tt class="py-op">]</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line"> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">                <tt class="py-name">default_cluster_threshold</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">coreset_power</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line"> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">                <tt class="py-comment"># determine cluster</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">                <tt class="py-comment">#TODO this part is too cryptic</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">                <tt class="py-comment"># amount_phi[j] = amount of basis functions per cluster j</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">                <tt class="py-name">amount_phi</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">ones</tt><tt class="py-op">(</tt><tt class="py-name">n_clusters</tt><tt class="py-op">,</tt><tt class="py-name">dtype</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">uint64</tt><tt class="py-op">)</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">                <tt class="py-name">amount_phi</tt><tt class="py-op">=</tt><tt class="py-name">amount_phi</tt><tt class="py-op">*</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">chi_matrix</tt><tt class="py-op">)</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">                <tt class="py-name">amount_phi_total</tt><tt class="py-op">=</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">chi_matrix</tt><tt class="py-op">)</tt>         </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line"> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">                <tt class="py-comment"># sort columns of chi and return new sorted args</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">                <tt class="py-name">arg_sort_cluster</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">argsort</tt><tt class="py-op">(</tt><tt class="py-name">chi_matrix</tt><tt class="py-op">,</tt><tt class="py-name">axis</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">                <tt class="py-comment"># sort columns of chi and return new sorted chi</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">                <tt class="py-comment"># notice that the last row has to be [1 ... 1]</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">                <tt class="py-name">sort_cluster</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">sort</tt><tt class="py-op">(</tt><tt class="py-name">chi_matrix</tt><tt class="py-op">,</tt><tt class="py-name">axis</tt><tt class="py-op">=</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">                <tt class="py-comment"># show_cluster contains arrays of the type [a b] where a is the row</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">                <tt class="py-comment"># and b the column of the entry from chi matrix  where </tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">                <tt class="py-comment"># chi_sorted(a,b) &gt; default_cluster_threshold</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">                <tt class="py-name">show_cluster</tt><tt class="py-op">=</tt><tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">argwhere</tt><tt class="py-op">(</tt><tt class="py-name">sort_cluster</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">0.5</tt> <tt class="py-op">)</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">                <tt class="py-comment"># from the above it could be clear</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">                <tt class="py-comment"># that the amount of phi function</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">                <tt class="py-comment"># of cluster i is given by x where x the number so that </tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">                <tt class="py-comment"># [x i] is in show_cluster and for all </tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">                <tt class="py-comment"># [y i] in show_cluster we have x&gt;y </tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">                <tt class="py-comment"># we define amount_phi[i]=x     </tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">element</tt> <tt class="py-keyword">in</tt> <tt class="py-name">show_cluster</tt><tt class="py-op">:</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">                        <tt id="link-39" class="py-name" targets="Method ZIBMolPy.internals.Converter.index()=ZIBMolPy.internals.Converter-class.html#index,Variable ZIBMolPy.internals.InternalCoordinate.index=ZIBMolPy.internals.InternalCoordinate-class.html#index"><a title="ZIBMolPy.internals.Converter.index
ZIBMolPy.internals.InternalCoordinate.index" class="py-name" href="#" onclick="return doclink('link-39', 'index', 'link-39');">index</a></tt><tt class="py-op">=</tt><tt class="py-name">element</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">                        <tt class="py-name">cluster</tt><tt class="py-op">=</tt><tt class="py-name">element</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">                        <tt class="py-keyword">if</tt> <tt class="py-name">amount_phi</tt><tt class="py-op">[</tt><tt class="py-name">cluster</tt><tt class="py-op">]</tt><tt class="py-op">&gt;</tt><tt id="link-40" class="py-name"><a title="ZIBMolPy.internals.Converter.index
ZIBMolPy.internals.InternalCoordinate.index" class="py-name" href="#" onclick="return doclink('link-40', 'index', 'link-39');">index</a></tt><tt class="py-op">:</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">                                <tt class="py-name">amount_phi</tt><tt class="py-op">[</tt><tt class="py-name">cluster</tt><tt class="py-op">]</tt><tt class="py-op">=</tt><tt id="link-41" class="py-name"><a title="ZIBMolPy.internals.Converter.index
ZIBMolPy.internals.InternalCoordinate.index" class="py-name" href="#" onclick="return doclink('link-41', 'index', 'link-39');">index</a></tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line"> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">                <tt class="py-comment"># create cluster list which contains arrays</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">                <tt class="py-comment"># each array consinst of a set of numbers corresponding to </tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">                <tt class="py-comment"># the phi function of node_number</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">                <tt class="py-name">cluster</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">i</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">,</tt><tt class="py-name">n_clusters</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">                        <tt class="py-name">cluster_set</tt><tt class="py-op">=</tt><tt class="py-op">[</tt><tt class="py-op">]</tt>           </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt class="py-name">j</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">amount_phi</tt><tt class="py-op">[</tt><tt class="py-name">i</tt><tt class="py-op">]</tt><tt class="py-op">,</tt><tt class="py-name">amount_phi_total</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">                                <tt class="py-comment">#if (j &lt; amount_phi[i] + 3):</tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">                                        <tt class="py-name">cluster_set</tt><tt class="py-op">.</tt><tt id="link-42" class="py-name" targets="Method ZIBMolPy.pool.NodeList.append()=ZIBMolPy.pool.NodeList-class.html#append"><a title="ZIBMolPy.pool.NodeList.append" class="py-name" href="#" onclick="return doclink('link-42', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">arg_sort_cluster</tt><tt class="py-op">[</tt><tt class="py-name">j</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">i</tt><tt class="py-op">]</tt><tt class="py-op">)</tt>       </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">                        <tt class="py-name">cluster</tt><tt class="py-op">.</tt><tt id="link-43" class="py-name"><a title="ZIBMolPy.pool.NodeList.append" class="py-name" href="#" onclick="return doclink('link-43', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">cluster_set</tt><tt class="py-op">)</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line"> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-name">i</tt> <tt class="py-keyword">in</tt> <tt class="py-name">range</tt><tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">cluster</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">                        <tt class="py-name">counter</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt class="py-name">node_index</tt> <tt class="py-keyword">in</tt> <tt class="py-name">cluster</tt><tt class="py-op">[</tt><tt class="py-name">i</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">                                <tt class="py-name">counter</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">                                <tt class="py-comment"># and ignore nodes which have a higher chi value then default_cluster_threshold</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">                                <tt class="py-keyword">if</tt><tt class="py-op">(</tt> <tt class="py-name">chi_matrix</tt><tt class="py-op">[</tt><tt class="py-name">node_index</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-name">i</tt><tt class="py-op">]</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">default_cluster_threshold</tt> <tt class="py-keyword">and</tt> <tt class="py-name">counter</tt><tt class="py-op">&gt;</tt><tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">min_nodes</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">                                        <tt class="py-keyword">continue</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">                                 </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line">                                <tt id="link-44" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-44', 'node', 'link-4');">node</a></tt> <tt class="py-op">=</tt> <tt class="py-name">active_nodes</tt><tt class="py-op">[</tt><tt class="py-name">node_index</tt><tt class="py-op">]</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">                                <tt id="link-45" class="py-name" targets="Variable ZIBMolPy.node.Node.trajectory=ZIBMolPy.node.Node-class.html#trajectory"><a title="ZIBMolPy.node.Node.trajectory" class="py-name" href="#" onclick="return doclink('link-45', 'trajectory', 'link-45');">trajectory</a></tt><tt class="py-op">=</tt> <tt id="link-46" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-46', 'node', 'link-4');">node</a></tt><tt class="py-op">.</tt><tt id="link-47" class="py-name"><a title="ZIBMolPy.node.Node.trajectory" class="py-name" href="#" onclick="return doclink('link-47', 'trajectory', 'link-45');">trajectory</a></tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">                         </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">                                <tt class="py-keyword">print</tt> <tt class="py-string">"-----"</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line">                                <tt class="py-keyword">print</tt> <tt class="py-string">"Generating transition nodes for node %s..."</tt><tt class="py-op">%</tt><tt id="link-48" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-48', 'node', 'link-4');">node</a></tt><tt class="py-op">.</tt><tt id="link-49" class="py-name" targets="Variable ZIBMolPy.node.Node.name=ZIBMolPy.node.Node-class.html#name,Method ZIBMolPy.topology.Moleculetype.name()=ZIBMolPy.topology.Moleculetype-class.html#name"><a title="ZIBMolPy.node.Node.name
ZIBMolPy.topology.Moleculetype.name" class="py-name" href="#" onclick="return doclink('link-49', 'name', 'link-49');">name</a></tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">                         </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">                                <tt class="py-name">neighbour_frames</tt> <tt class="py-op">=</tt> <tt id="link-50" class="py-name" targets="Function zgf_create_pmatrix.get_indices_equidist()=zgf_create_pmatrix-module.html#get_indices_equidist,Function zgf_create_tnodes.get_indices_equidist()=zgf_create_tnodes-module.html#get_indices_equidist"><a title="zgf_create_pmatrix.get_indices_equidist
zgf_create_tnodes.get_indices_equidist" class="py-name" href="#" onclick="return doclink('link-50', 'get_indices_equidist', 'link-50');">get_indices_equidist</a></tt><tt class="py-op">(</tt><tt id="link-51" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-51', 'node', 'link-4');">node</a></tt><tt class="py-op">,</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">num_tnodes</tt><tt class="py-op">)</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">                 </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">                                <tt class="py-comment"># create transition node for node_index</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line">                                <tt class="py-keyword">for</tt> <tt class="py-name">frame_number</tt> <tt class="py-keyword">in</tt> <tt class="py-name">neighbour_frames</tt><tt class="py-op">:</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">                                        <tt class="py-keyword">print</tt> <tt class="py-string">"Using frame %d as starting configuration."</tt><tt class="py-op">%</tt><tt class="py-name">frame_number</tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt id="link-52" class="py-name"><a title="ZIBMolPy.node.Node" class="py-name" href="#" onclick="return doclink('link-52', 'Node', 'link-5');">Node</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">parent_frame_num</tt> <tt class="py-op">=</tt> <tt class="py-name">frame_number</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">parent</tt> <tt class="py-op">=</tt> <tt id="link-53" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-53', 'node', 'link-4');">node</a></tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">state</tt> <tt class="py-op">=</tt> <tt class="py-string">"created"</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">extensions_counter</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">extensions_max</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">num_runs</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">extensions_length</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">sampling_length</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">sampling_length</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">sampling_length</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt id="link-54" class="py-name" targets="Module ZIBMolPy.internals=ZIBMolPy.internals-module.html,Variable ZIBMolPy.pool.NodeList.internals=ZIBMolPy.pool.NodeList-class.html#internals"><a title="ZIBMolPy.internals
ZIBMolPy.pool.NodeList.internals" class="py-name" href="#" onclick="return doclink('link-54', 'internals', 'link-54');">internals</a></tt> <tt class="py-op">=</tt> <tt id="link-55" class="py-name"><a title="ZIBMolPy.node.Node.trajectory" class="py-name" href="#" onclick="return doclink('link-55', 'trajectory', 'link-45');">trajectory</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name" targets="Method ZIBMolPy.internals.InternalArray.getframe()=ZIBMolPy.internals.InternalArray-class.html#getframe"><a title="ZIBMolPy.internals.InternalArray.getframe" class="py-name" href="#" onclick="return doclink('link-56', 'getframe', 'link-56');">getframe</a></tt><tt class="py-op">(</tt><tt class="py-name">frame_number</tt><tt class="py-op">)</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">save_mode</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">save_mode</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">                                        <tt id="link-57" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-57', 'pool', 'link-1');">pool</a></tt><tt class="py-op">.</tt><tt id="link-58" class="py-name"><a title="ZIBMolPy.pool.NodeList.append" class="py-name" href="#" onclick="return doclink('link-58', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">                                        <tt class="py-name">n</tt><tt class="py-op">.</tt><tt id="link-59" class="py-name" targets="Method ZIBMolPy.node.Node.save()=ZIBMolPy.node.Node-class.html#save,Method ZIBMolPy.pool.Pool.save()=ZIBMolPy.pool.Pool-class.html#save"><a title="ZIBMolPy.node.Node.save
ZIBMolPy.pool.Pool.save" class="py-name" href="#" onclick="return doclink('link-59', 'save', 'link-59');">save</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">                                <tt class="py-keyword">print</tt> <tt class="py-string">"%d transition nodes generated."</tt><tt class="py-op">%</tt><tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">num_tnodes</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">                                <tt class="py-keyword">print</tt> <tt class="py-string">"-----"</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line"> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">                <tt id="link-60" class="py-name"><a title="zgf_setup_nodes" class="py-name" href="#" onclick="return doclink('link-60', 'zgf_setup_nodes', 'link-14');">zgf_setup_nodes</a></tt><tt class="py-op">.</tt><tt id="link-61" class="py-name" targets="Function zgf_analyze.main()=zgf_analyze-module.html#main,Function zgf_browser.main()=zgf_browser-module.html#main,Function zgf_cleanup.main()=zgf_cleanup-module.html#main,Function zgf_concatenate_stuff.main()=zgf_concatenate_stuff-module.html#main,Function zgf_create_nodes.main()=zgf_create_nodes-module.html#main,Function zgf_create_pmatrix.main()=zgf_create_pmatrix-module.html#main,Function zgf_create_pool.main()=zgf_create_pool-module.html#main,Function zgf_create_rates.main()=zgf_create_rates-module.html#main,Function zgf_create_tnodes.main()=zgf_create_tnodes-module.html#main,Function zgf_create_unrestrained_nodes.main()=zgf_create_unrestrained_nodes-module.html#main,Function zgf_discard_solvent.main()=zgf_discard_solvent-module.html#main,Function zgf_export_pool.main()=zgf_export_pool-module.html#main,Function zgf_extract_conformations.main()=zgf_extract_conformations-module.html#main,Function zgf_gauge_times.main()=zgf_gauge_times-module.html#main,Function zgf_genion.main()=zgf_genion-module.html#main,Function zgf_grompp.main()=zgf_grompp-module.html#main,Function zgf_mdrun.main()=zgf_mdrun-module.html#main,Function zgf_recover_state.main()=zgf_recover_state-module.html#main,Function zgf_refine.main()=zgf_refine-module.html#main,Function zgf_remove_nodes.main()=zgf_remove_nodes-module.html#main,Function zgf_rerun.main()=zgf_rerun-module.html#main,Function zgf_reweight.main()=zgf_reweight-module.html#main,Function zgf_reweight_wham.main()=zgf_reweight_wham-module.html#main,Function zgf_setup_nodes.main()=zgf_setup_nodes-module.html#main,Function zgf_solvate_nodes.main()=zgf_solvate_nodes-module.html#main,Function zgf_submit_job_HLRN.main()=zgf_submit_job_HLRN-module.html#main,Function zgf_test.main()=zgf_test-module.html#main,Function zgf_upgrade.main()=zgf_upgrade-module.html#main"><a title="zgf_analyze.main
zgf_browser.main
zgf_cleanup.main
zgf_concatenate_stuff.main
zgf_create_nodes.main
zgf_create_pmatrix.main
zgf_create_pool.main
zgf_create_rates.main
zgf_create_tnodes.main
zgf_create_unrestrained_nodes.main
zgf_discard_solvent.main
zgf_export_pool.main
zgf_extract_conformations.main
zgf_gauge_times.main
zgf_genion.main
zgf_grompp.main
zgf_mdrun.main
zgf_recover_state.main
zgf_refine.main
zgf_remove_nodes.main
zgf_rerun.main
zgf_reweight.main
zgf_reweight_wham.main
zgf_setup_nodes.main
zgf_solvate_nodes.main
zgf_submit_job_HLRN.main
zgf_test.main
zgf_upgrade.main" class="py-name" href="#" onclick="return doclink('link-61', 'main', 'link-61');">main</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">                <tt id="link-62" class="py-name"><a title="zgf_grompp" class="py-name" href="#" onclick="return doclink('link-62', 'zgf_grompp', 'link-15');">zgf_grompp</a></tt><tt class="py-op">.</tt><tt id="link-63" class="py-name"><a title="zgf_analyze.main
zgf_browser.main
zgf_cleanup.main
zgf_concatenate_stuff.main
zgf_create_nodes.main
zgf_create_pmatrix.main
zgf_create_pool.main
zgf_create_rates.main
zgf_create_tnodes.main
zgf_create_unrestrained_nodes.main
zgf_discard_solvent.main
zgf_export_pool.main
zgf_extract_conformations.main
zgf_gauge_times.main
zgf_genion.main
zgf_grompp.main
zgf_mdrun.main
zgf_recover_state.main
zgf_refine.main
zgf_remove_nodes.main
zgf_rerun.main
zgf_reweight.main
zgf_reweight_wham.main
zgf_setup_nodes.main
zgf_solvate_nodes.main
zgf_submit_job_HLRN.main
zgf_test.main
zgf_upgrade.main" class="py-name" href="#" onclick="return doclink('link-63', 'main', 'link-61');">main</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">         </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">                <tt class="py-name">cluster_dict</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt class="py-op">(</tt><tt class="py-name">ic</tt><tt class="py-op">,</tt><tt class="py-name">c</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">enumerate</tt><tt class="py-op">(</tt><tt class="py-name">cluster</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line">                        <tt class="py-name">cluster_dict</tt><tt class="py-op">[</tt><tt class="py-string">'cluster_%d'</tt><tt class="py-op">%</tt><tt class="py-name">ic</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">c</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line"> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line">                <tt class="py-comment"># save cluster</tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">                <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">savez</tt><tt class="py-op">(</tt><tt id="link-64" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-64', 'pool', 'link-1');">pool</a></tt><tt class="py-op">.</tt><tt id="link-65" class="py-name" targets="Variable ZIBMolPy.pool.Pool.analysis_dir=ZIBMolPy.pool.Pool-class.html#analysis_dir"><a title="ZIBMolPy.pool.Pool.analysis_dir" class="py-name" href="#" onclick="return doclink('link-65', 'analysis_dir', 'link-65');">analysis_dir</a></tt><tt class="py-op">+</tt><tt class="py-string">"core_set_cluster.npz"</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-name">cluster_dict</tt><tt class="py-op">)</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line"> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">transition_level</tt> <tt class="py-op">==</tt> <tt class="py-string">"nodes"</tt><tt class="py-op">:</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">                <tt class="py-keyword">for</tt> <tt id="link-66" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-66', 'node', 'link-4');">node</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">active_nodes</tt><tt class="py-op">:</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">                        <tt id="link-67" class="py-name"><a title="ZIBMolPy.node.Node.trajectory" class="py-name" href="#" onclick="return doclink('link-67', 'trajectory', 'link-45');">trajectory</a></tt><tt class="py-op">=</tt> <tt id="link-68" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-68', 'node', 'link-4');">node</a></tt><tt class="py-op">.</tt><tt id="link-69" class="py-name"><a title="ZIBMolPy.node.Node.trajectory" class="py-name" href="#" onclick="return doclink('link-69', 'trajectory', 'link-45');">trajectory</a></tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">                         </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">                        <tt class="py-comment"># TODO duplicate code... use the one above</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">                        <tt class="py-keyword">print</tt> <tt class="py-string">"-----"</tt> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">                        <tt class="py-keyword">print</tt> <tt class="py-string">"Generating transition nodes for node %s..."</tt><tt class="py-op">%</tt><tt id="link-70" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-70', 'node', 'link-4');">node</a></tt><tt class="py-op">.</tt><tt id="link-71" class="py-name"><a title="ZIBMolPy.node.Node.name
ZIBMolPy.topology.Moleculetype.name" class="py-name" href="#" onclick="return doclink('link-71', 'name', 'link-49');">name</a></tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line"> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">                        <tt class="py-name">neighbour_frames</tt> <tt class="py-op">=</tt> <tt id="link-72" class="py-name"><a title="zgf_create_pmatrix.get_indices_equidist
zgf_create_tnodes.get_indices_equidist" class="py-name" href="#" onclick="return doclink('link-72', 'get_indices_equidist', 'link-50');">get_indices_equidist</a></tt><tt class="py-op">(</tt><tt id="link-73" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-73', 'node', 'link-4');">node</a></tt><tt class="py-op">,</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">num_tnodes</tt><tt class="py-op">)</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line"> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">                        <tt class="py-comment"># create transition point for node_index</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt class="py-name">frame_number</tt> <tt class="py-keyword">in</tt> <tt class="py-name">neighbour_frames</tt><tt class="py-op">:</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">                                <tt class="py-keyword">print</tt> <tt class="py-string">"Using frame %d as starting configuration."</tt><tt class="py-op">%</tt><tt class="py-name">frame_number</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">                                <tt class="py-name">n</tt> <tt class="py-op">=</tt> <tt id="link-74" class="py-name"><a title="ZIBMolPy.node.Node" class="py-name" href="#" onclick="return doclink('link-74', 'Node', 'link-5');">Node</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">parent_frame_num</tt> <tt class="py-op">=</tt> <tt class="py-name">frame_number</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">parent</tt> <tt class="py-op">=</tt> <tt id="link-75" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-75', 'node', 'link-4');">node</a></tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">state</tt> <tt class="py-op">=</tt> <tt class="py-string">"created"</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">extensions_counter</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">extensions_max</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">num_runs</tt><tt class="py-op">-</tt><tt class="py-number">1</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">extensions_length</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">sampling_length</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">sampling_length</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">sampling_length</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt id="link-76" class="py-name"><a title="ZIBMolPy.internals
ZIBMolPy.pool.NodeList.internals" class="py-name" href="#" onclick="return doclink('link-76', 'internals', 'link-54');">internals</a></tt> <tt class="py-op">=</tt> <tt id="link-77" class="py-name"><a title="ZIBMolPy.node.Node.trajectory" class="py-name" href="#" onclick="return doclink('link-77', 'trajectory', 'link-45');">trajectory</a></tt><tt class="py-op">.</tt><tt id="link-78" class="py-name"><a title="ZIBMolPy.internals.InternalArray.getframe" class="py-name" href="#" onclick="return doclink('link-78', 'getframe', 'link-56');">getframe</a></tt><tt class="py-op">(</tt><tt class="py-name">frame_number</tt><tt class="py-op">)</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt class="py-name">save_mode</tt> <tt class="py-op">=</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">save_mode</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">                                <tt id="link-79" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-79', 'pool', 'link-1');">pool</a></tt><tt class="py-op">.</tt><tt id="link-80" class="py-name"><a title="ZIBMolPy.pool.NodeList.append" class="py-name" href="#" onclick="return doclink('link-80', 'append', 'link-42');">append</a></tt><tt class="py-op">(</tt><tt class="py-name">n</tt><tt class="py-op">)</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">                                <tt class="py-name">n</tt><tt class="py-op">.</tt><tt id="link-81" class="py-name"><a title="ZIBMolPy.node.Node.save
ZIBMolPy.pool.Pool.save" class="py-name" href="#" onclick="return doclink('link-81', 'save', 'link-59');">save</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">                        <tt class="py-keyword">print</tt> <tt class="py-string">"%d transition nodes generated."</tt><tt class="py-op">%</tt><tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">num_tnodes</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">                        <tt class="py-keyword">print</tt> <tt class="py-string">"-----"</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line"> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">                <tt id="link-82" class="py-name"><a title="zgf_setup_nodes" class="py-name" href="#" onclick="return doclink('link-82', 'zgf_setup_nodes', 'link-14');">zgf_setup_nodes</a></tt><tt class="py-op">.</tt><tt id="link-83" class="py-name"><a title="zgf_analyze.main
zgf_browser.main
zgf_cleanup.main
zgf_concatenate_stuff.main
zgf_create_nodes.main
zgf_create_pmatrix.main
zgf_create_pool.main
zgf_create_rates.main
zgf_create_tnodes.main
zgf_create_unrestrained_nodes.main
zgf_discard_solvent.main
zgf_export_pool.main
zgf_extract_conformations.main
zgf_gauge_times.main
zgf_genion.main
zgf_grompp.main
zgf_mdrun.main
zgf_recover_state.main
zgf_refine.main
zgf_remove_nodes.main
zgf_rerun.main
zgf_reweight.main
zgf_reweight_wham.main
zgf_setup_nodes.main
zgf_solvate_nodes.main
zgf_submit_job_HLRN.main
zgf_test.main
zgf_upgrade.main" class="py-name" href="#" onclick="return doclink('link-83', 'main', 'link-61');">main</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">                <tt id="link-84" class="py-name"><a title="zgf_grompp" class="py-name" href="#" onclick="return doclink('link-84', 'zgf_grompp', 'link-15');">zgf_grompp</a></tt><tt class="py-op">.</tt><tt id="link-85" class="py-name"><a title="zgf_analyze.main
zgf_browser.main
zgf_cleanup.main
zgf_concatenate_stuff.main
zgf_create_nodes.main
zgf_create_pmatrix.main
zgf_create_pool.main
zgf_create_rates.main
zgf_create_tnodes.main
zgf_create_unrestrained_nodes.main
zgf_discard_solvent.main
zgf_export_pool.main
zgf_extract_conformations.main
zgf_gauge_times.main
zgf_genion.main
zgf_grompp.main
zgf_mdrun.main
zgf_recover_state.main
zgf_refine.main
zgf_remove_nodes.main
zgf_rerun.main
zgf_reweight.main
zgf_reweight_wham.main
zgf_setup_nodes.main
zgf_solvate_nodes.main
zgf_submit_job_HLRN.main
zgf_test.main
zgf_upgrade.main" class="py-name" href="#" onclick="return doclink('link-85', 'main', 'link-61');">main</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line"> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line"> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">        <tt class="py-name">instructionFile</tt> <tt class="py-op">=</tt> <tt id="link-86" class="py-name"><a title="ZIBMolPy.node.Node.pool
ZIBMolPy.pool" class="py-name" href="#" onclick="return doclink('link-86', 'pool', 'link-1');">pool</a></tt><tt class="py-op">.</tt><tt id="link-87" class="py-name"><a title="ZIBMolPy.pool.Pool.analysis_dir" class="py-name" href="#" onclick="return doclink('link-87', 'analysis_dir', 'link-65');">analysis_dir</a></tt><tt class="py-op">+</tt><tt class="py-string">"instruction.txt"</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line"> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">        <tt class="py-name">f</tt> <tt class="py-op">=</tt> <tt class="py-name">open</tt><tt class="py-op">(</tt><tt class="py-name">instructionFile</tt><tt class="py-op">,</tt> <tt class="py-string">"w"</tt><tt class="py-op">)</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">        <tt class="py-name">f</tt><tt class="py-op">.</tt><tt id="link-88" class="py-name" targets="Method ZIBMolPy.io.topology.Moleculetype.write()=ZIBMolPy.io.topology.Moleculetype-class.html#write,Method ZIBMolPy.io.topology.Section.write()=ZIBMolPy.io.topology.Section-class.html#write,Method ZIBMolPy.io.topology.Topology.write()=ZIBMolPy.io.topology.Topology-class.html#write,Method ZIBMolPy.topology.Topology.write()=ZIBMolPy.topology.Topology-class.html#write"><a title="ZIBMolPy.io.topology.Moleculetype.write
ZIBMolPy.io.topology.Section.write
ZIBMolPy.io.topology.Topology.write
ZIBMolPy.topology.Topology.write" class="py-name" href="#" onclick="return doclink('link-88', 'write', 'link-88');">write</a></tt><tt class="py-op">(</tt><tt class="py-string">"{'power': %f, 'tnodes': %d, 'level': '%s', 'min_nodes': %d}"</tt><tt class="py-op">%</tt><tt class="py-op">(</tt><tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">coreset_power</tt><tt class="py-op">,</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">num_tnodes</tt><tt class="py-op">,</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">transition_level</tt><tt class="py-op">,</tt> <tt class="py-name">options</tt><tt class="py-op">.</tt><tt class="py-name">min_nodes</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">        <tt class="py-name">f</tt><tt class="py-op">.</tt><tt id="link-89" class="py-name" targets="Method ZIBMolPy.io.trr.TrrFile.close()=ZIBMolPy.io.trr.TrrFile-class.html#close"><a title="ZIBMolPy.io.trr.TrrFile.close" class="py-name" href="#" onclick="return doclink('link-89', 'close', 'link-89');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line"> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line"> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line"><tt class="py-comment">#===============================================================================</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"><tt class="py-comment"># get equidistant indices </tt> </tt>
<a name="get_indices_equidist"></a><div id="get_indices_equidist-def"><a name="L208"></a><tt class="py-lineno">208</tt> <a class="py-toggle" href="#" id="get_indices_equidist-toggle" onclick="return toggle('get_indices_equidist');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="zgf_create_tnodes-module.html#get_indices_equidist">get_indices_equidist</a><tt class="py-op">(</tt><tt class="py-param">node</tt><tt class="py-op">,</tt> <tt class="py-param">n_neighbours</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="get_indices_equidist-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="get_indices_equidist-expanded"><a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">np</tt><tt class="py-op">.</tt><tt class="py-name">linspace</tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">,</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-90" class="py-name"><a title="ZIBMolPy.node" class="py-name" href="#" onclick="return doclink('link-90', 'node', 'link-4');">node</a></tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="ZIBMolPy.node.Node.trajectory" class="py-name" href="#" onclick="return doclink('link-91', 'trajectory', 'link-45');">trajectory</a></tt><tt class="py-op">)</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">num</tt><tt class="py-op">=</tt><tt class="py-name">n_neighbours</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">astype</tt><tt class="py-op">(</tt><tt class="py-name">int</tt><tt class="py-op">)</tt> </tt>
</div><a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line"> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line"> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line"><tt class="py-comment">#===============================================================================</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line"><tt class="py-keyword">if</tt><tt class="py-op">(</tt><tt class="py-name">__name__</tt> <tt class="py-op">==</tt> <tt class="py-string">"__main__"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">        <tt id="link-92" class="py-name"><a title="zgf_analyze.main
zgf_browser.main
zgf_cleanup.main
zgf_concatenate_stuff.main
zgf_create_nodes.main
zgf_create_pmatrix.main
zgf_create_pool.main
zgf_create_rates.main
zgf_create_tnodes.main
zgf_create_unrestrained_nodes.main
zgf_discard_solvent.main
zgf_export_pool.main
zgf_extract_conformations.main
zgf_gauge_times.main
zgf_genion.main
zgf_grompp.main
zgf_mdrun.main
zgf_recover_state.main
zgf_refine.main
zgf_remove_nodes.main
zgf_rerun.main
zgf_reweight.main
zgf_reweight_wham.main
zgf_setup_nodes.main
zgf_solvate_nodes.main
zgf_submit_job_HLRN.main
zgf_test.main
zgf_upgrade.main" class="py-name" href="#" onclick="return doclink('link-92', 'main', 'link-61');">main</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line"> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line"><tt class="py-comment">#EOF</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="ZIBMolPy-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="https://wiki.kobv.de/confluence/display/AGCMD/ZIBMolPy">ZIBMolPy</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Feb 13 11:19:38 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
